<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sign in â€” MYQER</title>
  <link rel="icon" href="/images/icon-192.png">
  <link rel="stylesheet" href="/styles/css">
</head>
<body class="app-page">
  <main class="auth-card" role="main" aria-labelledby="title">
    <h1 id="title">Sign in</h1>

    <label class="auth-label" for="email">Email</label>
    <input id="email" class="field" type="email" autocomplete="email" placeholder="you@example.com" required>

    <label class="auth-label" for="password">Password</label>
    <div class="password-wrapper">
      <input id="password" class="field" type="password" autocomplete="current-password" placeholder="Your password" required>
      <button id="toggle" type="button" class="password-toggle" aria-pressed="false" aria-controls="password">Show</button>
    </div>

    <div class="auth-actions" style="max-width:420px;margin-inline:auto">
      <button id="btnLogin" class="btn btn-primary" type="button">Sign in</button>
      <a class="btn btn-secondary" href="/register.html">Create account</a>
      <a class="btn btn-link" href="/reset.html">Forgot password?</a>
    </div>

    <div id="msg" class="tiny muted" style="text-align:center;margin-top:10px;"></div>
  </main>

  <script type="module">
  import { requireAuth, signOutToLogin, supabase, q } from '/scripts/auth.js';

  // Gate the page
  const session = await requireAuth();

  // Wire Logout (top-right)
  const btn = document.getElementById('logout');
  if (btn) btn.addEventListener('click', signOutToLogin);

  // (Optional) use the authed user id/email anywhere you need:
  const user = session.user;
  // e.g., q('#full_name').value = user.user_metadata?.full_name || '';
</script>
</body>
</html>
