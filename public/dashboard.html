<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>MYQER â€” Dashboard</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- QR Code -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>

  <!-- Supabase v2: single client (NO top-level await; iPad/Safari-safe) -->
  <!--<script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
    const SUPABASE_URL = 'https://tgddpmxpbgrzrbzpomou.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRnZGRwbXhwYmdyenJienBvbW91Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwNDgxMTMsImV4cCI6MjA3MTYyNDExM30.uXntx0rZISv927MQAG1LgGKA-lA08hSkzXMre7Bk2QM';
    // One global name only; rest of the page uses window.sb
    window.sb = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  </script>--> 

  <style>
    :root{
      --brand:#c62828;
      --ink:#0f172a;
      --muted:#64748b;
      --ring:rgba(198,40,40,.14);
      --stroke:rgba(15,23,42,.08);
      --shadow:0 18px 42px rgba(2,8,23,.12), 0 2px 6px rgba(2,8,23,.06);
      --rad:16px;
    }
    body{background:linear-gradient(135deg,#f8fafc 0%,#eef2f7 100%);color:var(--ink)}
    .glass{background:rgba(255,255,255,.7);backdrop-filter:blur(14px);border:1px solid var(--stroke)}
    .card{background:rgba(255,255,255,.9);backdrop-filter:blur(10px);border:1px solid var(--stroke);border-radius:var(--rad);box-shadow:var(--shadow)}
    .ribbon{position:relative;padding-top:14px}
    .ribbon::before{content:attr(data-title);position:absolute;top:0;left:-1px;font-weight:800;font-size:.78rem;letter-spacing:.02em;color:#fff;padding:.28rem .6rem;border-top-left-radius:10px;border-bottom-right-radius:10px}
    .r-red::before{background:#dc2626}
    .r-orange::before{background:#ea580c}
    .r-green::before{background:#16a34a}
    .r-purple::before{background:#7c3aed}
    .pill{border-radius:999px;border:1px solid var(--stroke);background:#fff;padding:.3rem .6rem;font-size:.75rem}
    .btn{display:inline-flex;align-items:center;justify-content:center;border-radius:10px;font-weight:700}
    .btn-red{background:var(--brand);color:#fff}
    .btn-red:hover{filter:brightness(1.02)}
    .btn-outline{border:1px solid var(--brand);color:var(--brand);background:#fff}
    .kicker{font-size:.7rem;color:#64748b}
    .qr-ring{box-shadow:0 0 0 2px var(--brand), 0 8px 20px var(--ring);border-radius:14px}
    .disabled-tile{opacity:.55;cursor:not-allowed}
    .legend-dot{width:.65rem;height:.65rem;border-radius:999px;display:inline-block;margin-right:.4rem}
  </style>
</head>
<body class="min-h-screen">

  <!-- Top Bar -->
  <header class="glass sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="h-16 flex items-center justify-between">
        <a href="/" class="flex items-center gap-2 font-extrabold text-xl">
          MYQ<span class="text-[var(--brand)]">ER</span><sup class="text-xs ml-0.5">â„¢</sup>
        </a>

        <nav class="hidden sm:flex items-center gap-6 text-sm">
          <a href="/" class="hover:underline">Back to Home</a>
        </nav>

        <div class="flex items-center gap-3">
          <!-- Language -->
          <select id="lang" class="border rounded-md px-3 py-1 text-sm">
            <option value="en">ðŸ‡ºðŸ‡¸ EN</option>
            <option value="es">ðŸ‡ªðŸ‡¸ ES</option>
            <option value="fr">ðŸ‡«ðŸ‡· FR</option>
            <option value="de">ðŸ‡©ðŸ‡ª DE</option>
            <option value="it">ðŸ‡®ðŸ‡¹ IT</option>
            <option value="pt">ðŸ‡µðŸ‡¹ PT</option>
            <option value="ro">ðŸ‡·ðŸ‡´ RO</option>
            <option value="ar">ðŸ‡¸ðŸ‡¦ AR</option>
            <option value="hi">ðŸ‡®ðŸ‡³ HI</option>
            <option value="zh">ðŸ‡¨ðŸ‡³ ä¸­æ–‡</option>
          </select>

          <button id="logoutBtn" class="btn btn-outline px-4 py-2 text-sm">Logout</button>
        </div>
      </div>
    </div>
  </header>

  <!-- Loading / Error -->
  <div id="loading" class="flex items-center justify-center min-h-[40vh]">
    <div class="text-center">
      <div class="animate-spin h-10 w-10 rounded-full border-b-2 border-[var(--brand)] mx-auto mb-3"></div>
      <p class="text-[var(--muted)]">Loading your dashboardâ€¦</p>
    </div>
  </div>

  <div id="errorBox" class="hidden max-w-3xl mx-auto mt-8 card p-5">
    <div class="text-red-600 font-bold mb-1">Something went wrong</div>
    <div id="errorMsg" class="text-sm text-slate-600"></div>
  </div>

  <!-- Dashboard -->
  <main id="dash" class="hidden pt-6 pb-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 grid grid-cols-1 lg:grid-cols-3 gap-8">

      <!-- LEFT / CENTER: Main forms -->
      <div class="lg:col-span-2 space-y-8">

        <!-- Identity â€“ Personal Information -->
        <section class="card p-6 ribbon r-green" data-title="Identity">
          <h2 class="text-xl font-extrabold mb-1" data-i18n="identityTitle">Identity â€” Personal Information</h2>
          <p class="kicker mb-5" data-i18n="identityHint">These details help responders confirm who you are.</p>

          <form id="profileForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="text-sm font-medium" data-i18n="fullName">Full name</label>
              <input name="full_name" class="w-full mt-1 border rounded-md px-3 py-2">
            </div>
            <div>
              <label class="text-sm font-medium" data-i18n="dob">Date of Birth</label>
              <input name="date_of_birth" type="date" class="w-full mt-1 border rounded-md px-3 py-2">
            </div>
            <div>
              <label class="text-sm font-medium" data-i18n="country">Country</label>
              <input name="country" class="w-full mt-1 border rounded-md px-3 py-2">
            </div>
            <div>
              <label class="text-sm font-medium" data-i18n="nationalId">National ID (optional)</label>
              <input name="national_id" class="w-full mt-1 border rounded-md px-3 py-2">
            </div>
            <div class="md:col-span-2 flex items-center justify-between">
              <div>
                <span class="kicker" data-i18n="codeLabel">Your card code:</span>
                <code id="codeText" class="ml-2 px-2 py-1 rounded bg-slate-100 text-[.85rem]">â€”</code>
              </div>
              <div class="flex gap-2">
                <button type="button" id="genCode" class="btn px-3 py-2 border" data-i18n="genCode">Generate code</button>
                <button class="btn btn-red px-4 py-2" data-i18n="saveProfile">Save Profile</button>
              </div>
            </div>
          </form>
        </section>

        <!-- Critical â€“ Medical â€“ Health Details -->
        <section class="card p-6 ribbon r-red" data-title="Critical">
          <h2 class="text-xl font-extrabold mb-1" data-i18n="criticalTitle">Critical â€” Medical â€” Health Details</h2>
          <p class="kicker mb-5" data-i18n="criticalHint">Keep this current. It appears on your emergency card.</p>

          <form id="healthForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="text-sm font-medium" data-i18n="bloodType">Blood type</label>
              <select name="blood_type" class="w-full mt-1 border rounded-md px-3 py-2">
                <option value="">â€”</option>
                <option>A+</option><option>A-</option>
                <option>B+</option><option>B-</option>
                <option>AB+</option><option>AB-</option>
                <option>O+</option><option>O-</option>
              </select>
            </div>

            <div>
              <label class="text-sm font-medium" data-i18n="organDonor">Organ donor</label>
              <select name="organ_donor" class="w-full mt-1 border rounded-md px-3 py-2">
                <option value="">â€”</option>
                <option value="yes" data-i18n="yes">Yes</option>
                <option value="no" data-i18n="no">No</option>
              </select>
            </div>

            <div class="md:col-span-2">
              <label class="text-sm font-medium" data-i18n="allergies">Critical allergies</label>
              <textarea name="allergies" rows="2" class="w-full mt-1 border rounded-md px-3 py-2" placeholder="Penicillin, Nuts"></textarea>
            </div>

            <div class="md:col-span-2">
              <label class="text-sm font-medium" data-i18n="conditions">Conditions</label>
              <textarea name="conditions" rows="2" class="w-full mt-1 border rounded-md px-3 py-2" placeholder="Diabetes, Asthma"></textarea>
            </div>

            <div class="md:col-span-2">
              <label class="text-sm font-medium" data-i18n="meds">Current medications</label>
              <textarea name="meds" rows="2" class="w-full mt-1 border rounded-md px-3 py-2" placeholder="Metformin"></textarea>
            </div>

            <div class="md:col-span-2">
              <label class="text-sm font-medium" data-i18n="implants">Implants / devices</label>
              <textarea name="implants" rows="2" class="w-full mt-1 border rounded-md px-3 py-2" placeholder="Pacemaker, Insulin pump"></textarea>
            </div>

            <div class="md:col-span-2">
              <label class="text-sm font-medium" data-i18n="lifeSupport">Life support preference (informational)</label>
              <select name="life_support_pref" class="w-full mt-1 border rounded-md px-3 py-2">
                <option value="">â€”</option>
                <option data-i18n="fullSupport" value="Full support">All resuscitation efforts (Full)</option>
                <option data-i18n="comfortOnly" value="Comfort only">Comfort-focused care only</option>
                <option data-i18n="dnr" value="DNR">Do not resuscitate (DNR)</option>
              </select>
              <p class="kicker mt-1" data-i18n="lifeSupportNote">These preferences are informational only. Clinicians must confirm with official documents.</p>
            </div>

            <div class="md:col-span-2 flex justify-end">
              <button class="btn btn-red px-4 py-2" data-i18n="saveHealth">Save Health</button>
            </div>
          </form>
        </section>

        <!-- Emergency Contacts (ICE) -->
        <section class="card p-6 ribbon r-orange" data-title="ICE">
          <div class="flex items-center justify-between mb-2">
            <h2 class="text-xl font-extrabold" data-i18n="iceTitle">Emergency Contacts (ICE)</h2>
            <button id="addIce" class="btn btn-outline px-3 py-2 text-sm" data-i18n="addContact">Add contact</button>
          </div>
          <p class="kicker mb-4" data-i18n="iceHint">Add up to 3 trusted contacts.</p>
          <div id="iceList" class="space-y-3"></div>
        </section>

        <!-- Document Vault (Coming Soon) -->
        <section class="card p-6 ribbon r-purple" data-title="Document Vault">
          <h2 class="text-xl font-extrabold mb-1" data-i18n="vaultTitle">Document Vault (Coming Soon)</h2>
          <p class="kicker mb-5" data-i18n="vaultHint">Secure, client-side encrypted storage for critical documents.</p>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
            <div class="disabled-tile border rounded-lg p-4 flex items-center gap-3">
              <span class="legend-dot" style="background:#7c3aed"></span>
              <div>
                <div class="font-semibold" data-i18n="dnr">DNR Orders</div>
                <div class="kicker">â€”</div>
              </div>
            </div>
            <div class="disabled-tile border rounded-lg p-4 flex items-center gap-3">
              <span class="legend-dot" style="background:#7c3aed"></span>
              <div>
                <div class="font-semibold" data-i18n="livingWill">Living Will</div>
                <div class="kicker">â€”</div>
              </div>
            </div>
            <div class="disabled-tile border rounded-lg p-4 flex items-center gap-3">
              <span class="legend-dot" style="background:#7c3aed"></span>
              <div>
                <div class="font-semibold" data-i18n="mpoa">Medical Power of Attorney</div>
                <div class="kicker">â€”</div>
              </div>
            </div>
            <div class="disabled-tile border rounded-lg p-4 flex items-center gap-3">
              <span class="legend-dot" style="background:#7c3aed"></span>
              <div>
                <div class="font-semibold" data-i18n="insurance">Insurance Documents</div>
                <div class="kicker">â€”</div>
              </div>
            </div>
          </div>
        </section>

        <!-- Danger zone: Delete Account -->
        <section class="card p-6 border-2 border-red-300">
          <h2 class="text-xl font-extrabold text-red-700 mb-2" data-i18n="deleteTitle">Delete account</h2>
          <p class="kicker mb-3" data-i18n="deleteWarning">Type <strong>DELETE MY ACCOUNT</strong> to enable. This is permanent.</p>
          <div class="flex flex-col sm:flex-row gap-3">
            <input id="deletePhrase" class="border rounded-md px-3 py-2 flex-1" placeholder="DELETE MY ACCOUNT">
            <button id="deleteBtn" class="btn px-4 py-2 bg-red-600 text-white disabled:opacity-50" disabled data-i18n="deleteBtn">Delete my account</button>
          </div>
          <p id="deleteNote" class="kicker mt-2"></p>
        </section>

      </div>

      <!-- RIGHT: Triage, QR, Legend -->
      <aside class="space-y-8">

        <!-- Triage Status -->
        <section class="card p-6">
          <div class="flex items-center justify-between mb-2">
            <h3 class="text-lg font-extrabold" data-i18n="triageTitle">Emergency Triage Status</h3>
            <span id="triagePill" class="pill">â€”</span>
          </div>
          <p class="kicker mb-4" data-i18n="triageHint">Auto-computed from your data. You can override.</p>

          <div class="grid grid-cols-1 gap-3">
            <div>
              <label class="text-sm font-medium" data-i18n="override">Manual override</label>
              <select id="triageOverride" class="w-full mt-1 border rounded-md px-3 py-2">
                <option value="">Auto</option>
                <option value="green">Green</option>
                <option value="amber">Amber</option>
                <option value="red">Red</option>
                <option value="black">Black</option>
              </select>
            </div>

            <div class="flex gap-2">
              <button id="speak" class="btn btn-outline px-3 py-2 text-sm" data-i18n="speak">ðŸ”ˆ Speak summary</button>
              <button id="stopSpeak" class="btn px-3 py-2 border text-sm" data-i18n="stop">Stop</button>
            </div>
          </div>
        </section>

        <!-- Emergency Card & QR -->
        <section class="card p-6">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-lg font-extrabold" data-i18n="cardTitle">Emergency Card & QR</h3>
            <span class="kicker" id="qrStatus"></span>
          </div>

          <div class="grid grid-cols-1 gap-3">
            <div class="flex items-center justify-center">
              <div class="qr-ring bg-white p-3 rounded-xl">
                <canvas id="qrCanvas" width="200" height="200"></canvas>
              </div>
            </div>

            <div class="text-center">
              <div class="text-xs text-slate-500 mb-1" data-i18n="scanTip">Scan for emergency access</div>
              <div class="font-mono text-sm" id="codeUnderQR">â€”</div>
            </div>

            <div>
              <label class="text-sm font-medium" data-i18n="cardLink">Card link</label>
              <div class="flex gap-2 mt-1">
                <input id="cardUrl" class="border rounded-md px-3 py-2 flex-1" readonly>
                <button id="copyLink" class="btn btn-outline px-3 py-2 text-sm" data-i18n="copy">Copy</button>
              </div>
            </div>

            <div class="grid grid-cols-3 gap-2">
              <button id="dlPNG" class="btn px-2 py-2 border text-sm" data-i18n="png">PNG</button>
              <button id="dlSVG" class="btn px-2 py-2 border text-sm" data-i18n="svg">SVG</button>
              <button id="printQR" class="btn px-2 py-2 border text-sm" data-i18n="print">Print</button>
            </div>
          </div>
        </section>

        <!-- Legend + Disclaimers -->
        <section class="card p-6">
          <h3 class="text-lg font-extrabold mb-2" data-i18n="legend">Triage colours</h3>
          <ul class="space-y-1 text-sm">
            <li><span class="legend-dot" style="background:#16a34a"></span><strong>Green</strong> â€” mild allergies, no major conditions.</li>
            <li><span class="legend-dot" style="background:#f59e0b"></span><strong>Amber</strong> â€” stable chronic conditions.</li>
            <li><span class="legend-dot" style="background:#ef4444"></span><strong>Red</strong> â€” severe allergies / life-threatening conditions.</li>
            <li><span class="legend-dot" style="background:#111827"></span><strong>Black</strong> â€” DNR / Comfort care set.</li>
          </ul>

          <div class="mt-4 text-xs text-slate-500 space-y-2">
            <p data-i18n="infoOnly"><strong>Info only:</strong> This card supports care; clinicians must verify with official records.</p>
            <p data-i18n="privacyNote"><strong>Privacy:</strong> Your data stays on your device unless you share it. No ads, no trackers.</p>
            <p data-i18n="qrNote">Your QR code stays the same â€” it always opens your latest information.</p>
          </div>
        </section>

      </aside>
    </div>
  </main>

  <!-- Footer -->
  <footer class="mt-10 pb-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 text-center text-sm text-slate-500">
      Â© 2025 MYQER â€” My QR for Emergency Response Â· GDPR/HIPAA-minded Â·
      <a class="underline" href="/privacy.html">Privacy</a> Â·
      <a class="underline" href="/terms.html">Terms</a>
    </div>
  </footer>

  <!-- App Logic: i18n, data load/save, triage, QR, voice, logout, delete -->
  <script>
    <!-- App Logic: i18n, data load/save, triage, QR, voice, logout, delete -->
<script>
  // --- Create Supabase client reliably (works on iOS Safari too) ---
  const SUPABASE_URL = 'https://tgddpmxpbgrzrbzpomou.supabase.co';
  const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRnZGRwbXhwYmdyenJienBvbW91Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwNDgxMTMsImV4cCI6MjA3MTYyNDExM30.uXntx0rZISv927MQAG1LgGKA-lA08hSkzXMre7Bk2QM';

  let sb; // will hold the client

  async function initSupabase() {
    if (window.sb) { sb = window.sb; return; } // already available
    try {
      // primary CDN
      const { createClient } = await import('https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm');
      sb = window.sb = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    } catch (e1) {
      // fallback CDN (some Safari setups block jsdelivr)
      const { createClient } = await import('https://esm.sh/@supabase/supabase-js?bundle');
      sb = window.sb = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    }
  }

  // ------- i18n (10 languages) -------
  const t = {
    // ------- i18n (10 languages) -------
    const t = {
      en:{identityTitle:"Identity â€” Personal Information",identityHint:"These details help responders confirm who you are.",
          fullName:"Full name",dob:"Date of Birth",country:"Country",nationalId:"National ID (optional)",
          codeLabel:"Your card code:",genCode:"Generate code",saveProfile:"Save Profile",
          criticalTitle:"Critical â€” Medical â€” Health Details",criticalHint:"Keep this current. It appears on your emergency card.",
          bloodType:"Blood type",organDonor:"Organ donor",yes:"Yes",no:"No",allergies:"Critical allergies",
          conditions:"Conditions",meds:"Current medications",implants:"Implants / devices",
          lifeSupport:"Life support preference (informational)",lifeSupportNote:"These preferences are informational only. Clinicians must confirm with official documents.",
          saveHealth:"Save Health",iceTitle:"Emergency Contacts (ICE)",iceHint:"Add up to 3 trusted contacts.",
          addContact:"Add contact",triageTitle:"Emergency Triage Status",triageHint:"Auto-computed from your data. You can override.",
          override:"Manual override",speak:"Speak summary",stop:"Stop",cardTitle:"Emergency Card & QR",scanTip:"Scan for emergency access",
          cardLink:"Card link",copy:"Copy",png:"PNG",svg:"SVG",print:"Print",legend:"Triage colours",
          infoOnly:"Info only: This card supports care; clinicians must verify with official records.",
          privacyNote:"Privacy: Your data stays on your device unless you share it.",
          qrNote:"Your QR code stays the same â€” it always opens your latest information.",
          vaultTitle:"Document Vault (Coming Soon)",vaultHint:"Secure, client-side encrypted storage for critical documents.",
          dnr:"DNR Orders",livingWill:"Living Will",mpoa:"Medical Power of Attorney",insurance:"Insurance Documents",
          deleteTitle:"Delete account",deleteWarning:"Type DELETE MY ACCOUNT to enable. This is permanent.",deleteBtn:"Delete my account"},
      es:{identityTitle:"Identidad â€” InformaciÃ³n Personal",identityHint:"Estos datos ayudan a confirmar su identidad.",
          fullName:"Nombre completo",dob:"Fecha de nacimiento",country:"PaÃ­s",nationalId:"ID nacional (opcional)",
          codeLabel:"Tu cÃ³digo de tarjeta:",genCode:"Generar cÃ³digo",saveProfile:"Guardar perfil",
          criticalTitle:"CrÃ­tico â€” InformaciÃ³n MÃ©dica",criticalHint:"MantÃ©n esto actualizado. Aparece en tu tarjeta.",
          bloodType:"Grupo sanguÃ­neo",organDonor:"Donante de Ã³rganos",yes:"SÃ­",no:"No",allergies:"Alergias crÃ­ticas",
          conditions:"Condiciones",meds:"Medicamentos actuales",implants:"Implantes / dispositivos",
          lifeSupport:"Preferencia de soporte vital (informativo)",lifeSupportNote:"Solo informativo. Los clÃ­nicos deben verificar con documentos oficiales.",
          saveHealth:"Guardar salud",iceTitle:"Contactos de Emergencia (ICE)",iceHint:"Agrega hasta 3 contactos de confianza.",
          addContact:"AÃ±adir contacto",triageTitle:"Estado de Triaje",triageHint:"Se calcula automÃ¡ticamente. Puedes cambiarlo.",
          override:"AnulaciÃ³n manual",speak:"Reproducir resumen",stop:"Detener",cardTitle:"Tarjeta & QR",scanTip:"Escanee para acceso de emergencia",
          cardLink:"Enlace de tarjeta",copy:"Copiar",png:"PNG",svg:"SVG",print:"Imprimir",legend:"Colores de triaje",
          infoOnly:"Solo informativo: Verificar con registros oficiales.",
          privacyNote:"Privacidad: Tus datos permanecen en tu dispositivo.",
          qrNote:"Tu QR no cambia: siempre muestra la informaciÃ³n actual.",
          vaultTitle:"BÃ³veda de Documentos (PrÃ³ximamente)",vaultHint:"Almacenamiento cifrado del lado del cliente.",
          dnr:"Orden DNR",livingWill:"Testamento vital",mpoa:"Poder mÃ©dico",insurance:"Documentos de seguro",
          deleteTitle:"Eliminar cuenta",deleteWarning:"Escribe DELETE MY ACCOUNT para habilitar.",deleteBtn:"Eliminar mi cuenta"},
      fr:{identityTitle:"IdentitÃ© â€” Informations personnelles",identityHint:"Ces dÃ©tails aident Ã  confirmer votre identitÃ©.",
          fullName:"Nom complet",dob:"Date de naissance",country:"Pays",nationalId:"ID national (optionnel)",
          codeLabel:"Votre code de carte :",genCode:"GÃ©nÃ©rer le code",saveProfile:"Enregistrer le profil",
          criticalTitle:"Critique â€” Informations mÃ©dicales",criticalHint:"Gardez cela Ã  jour. ApparaÃ®t sur votre carte.",
          bloodType:"Groupe sanguin",organDonor:"Donneur d'organes",yes:"Oui",no:"Non",allergies:"Allergies critiques",
          conditions:"Affections",meds:"MÃ©dicaments actuels",implants:"Implants / dispositifs",
          lifeSupport:"PrÃ©fÃ©rence de soins intensifs (info)",lifeSupportNote:"Ã€ titre informatif uniquement.",
          saveHealth:"Enregistrer la santÃ©",iceTitle:"Contacts d'urgence (ICE)",iceHint:"Ajoutez jusqu'Ã  3 contacts.",
          addContact:"Ajouter un contact",triageTitle:"Statut de triage",triageHint:"CalculÃ© automatiquement.",
          override:"Remplacement manuel",speak:"Lire le rÃ©sumÃ©",stop:"ArrÃªter",cardTitle:"Carte d'urgence & QR",scanTip:"Scanner pour l'accÃ¨s d'urgence",
          cardLink:"Lien de la carte",copy:"Copier",png:"PNG",svg:"SVG",print:"Imprimer",legend:"Couleurs de triage",
          infoOnly:"Informations indicatives; vÃ©rification requise.",privacyNote:"Vos donnÃ©es restent sur votre appareil.",
          qrNote:"Le QR reste identique; contenu toujours Ã  jour.",
          vaultTitle:"Coffre de documents (BientÃ´t)",vaultHint:"Stockage chiffrÃ© cÃ´tÃ© client.",
          dnr:"Ordres DNR",livingWill:"Directives anticipÃ©es",mpoa:"Mandat mÃ©dical",insurance:"Assurance",
          deleteTitle:"Supprimer le compte",deleteWarning:"Tapez DELETE MY ACCOUNT pour activer.",deleteBtn:"Supprimer mon compte"},
      de:{identityTitle:"IdentitÃ¤t â€” PersÃ¶nliche Daten",identityHint:"Diese Angaben bestÃ¤tigen Ihre IdentitÃ¤t.",
          fullName:"VollstÃ¤ndiger Name",dob:"Geburtsdatum",country:"Land",nationalId:"Nationale ID (optional)",
          codeLabel:"Ihr Karten-Code:",genCode:"Code erzeugen",saveProfile:"Profil speichern",
          criticalTitle:"Kritisch â€” Medizinische Angaben",criticalHint:"Aktuell halten. Erscheint auf der Notfallkarte.",
          bloodType:"Blutgruppe",organDonor:"Organspender",yes:"Ja",no:"Nein",allergies:"Kritische Allergien",
          conditions:"Erkrankungen",meds:"Aktuelle Medikamente",implants:"Implantate / GerÃ¤te",
          lifeSupport:"LebenserhaltungsprÃ¤ferenz (Info)",lifeSupportNote:"Nur informativ. Ã„rztliche BestÃ¤tigung nÃ¶tig.",
          saveHealth:"Gesundheit speichern",iceTitle:"Notfallkontakte (ICE)",iceHint:"Bis zu 3 Kontakte.",
          addContact:"Kontakt hinzufÃ¼gen",triageTitle:"Triage-Status",triageHint:"Automatisch berechnet.",
          override:"Manuell Ã¼berschreiben",speak:"Zusammenfassung sprechen",stop:"Stopp",cardTitle:"Notfallkarte & QR",scanTip:"FÃ¼r Notfallzugriff scannen",
          cardLink:"Kartenlink",copy:"Kopieren",png:"PNG",svg:"SVG",print:"Drucken",legend:"Triage-Farben",
          infoOnly:"Nur als UnterstÃ¼tzung; Ã¤rztl. PrÃ¼fung nÃ¶tig.",
          privacyNote:"Daten bleiben auf Ihrem GerÃ¤t.",
          qrNote:"QR bleibt gleich â€” zeigt immer aktuelle Infos.",
          vaultTitle:"Dokumenten-Tresor (Bald)",vaultHint:"Client-seitig verschlÃ¼sselt.",
          dnr:"DNR-Anordnung",livingWill:"PatientenverfÃ¼gung",mpoa:"Vorsorgevollmacht",insurance:"Versicherung",
          deleteTitle:"Konto lÃ¶schen",deleteWarning:"DELETE MY ACCOUNT eingeben.",deleteBtn:"Konto lÃ¶schen"},
      it:{identityTitle:"IdentitÃ  â€” Informazioni personali",identityHint:"Aiuta i soccorritori a confermare la tua identitÃ .",
          fullName:"Nome completo",dob:"Data di nascita",country:"Paese",nationalId:"ID nazionale (opz.)",
          codeLabel:"Codice tessera:",genCode:"Genera codice",saveProfile:"Salva profilo",
          criticalTitle:"Critico â€” Dati sanitari",criticalHint:"Tienili aggiornati. Appaiono sulla tessera.",
          bloodType:"Gruppo sanguigno",organDonor:"Donatore di organi",yes:"SÃ¬",no:"No",allergies:"Allergie critiche",
          conditions:"Condizioni",meds:"Farmaci in uso",implants:"Impianti / dispositivi",
          lifeSupport:"Preferenze di rianimazione (info)",lifeSupportNote:"Solo informativo.",
          saveHealth:"Salva salute",iceTitle:"Contatti di emergenza (ICE)",iceHint:"Fino a 3 contatti.",
          addContact:"Aggiungi contatto",triageTitle:"Stato triage",triageHint:"Calcolato automaticamente.",
          override:"Override manuale",speak:"Voce: riepilogo",stop:"Stop",cardTitle:"Tessera & QR",scanTip:"Scansiona per accesso",
          cardLink:"Link tessera",copy:"Copia",png:"PNG",svg:"SVG",print:"Stampa",legend:"Colori triage",
          infoOnly:"Solo supporto; serve verifica clinica.",
          privacyNote:"Dati sul tuo dispositivo.",
          qrNote:"Il QR non cambia, mostra sempre i dati aggiornati.",
          vaultTitle:"Vault documenti (Prossimamente)",vaultHint:"Cifratura lato client.",
          dnr:"Ordini DNR",livingWill:"Testamento biologico",mpoa:"Delega sanitaria",insurance:"Assicurazione",
          deleteTitle:"Elimina account",deleteWarning:"Scrivi DELETE MY ACCOUNT.",deleteBtn:"Elimina account"},
      pt:{identityTitle:"Identidade â€” InformaÃ§Ãµes Pessoais",identityHint:"Ajuda a confirmar quem vocÃª Ã©.",
          fullName:"Nome completo",dob:"Data de nascimento",country:"PaÃ­s",nationalId:"ID nacional (opcional)",
          codeLabel:"Seu cÃ³digo:",genCode:"Gerar cÃ³digo",saveProfile:"Salvar perfil",
          criticalTitle:"CrÃ­tico â€” SaÃºde",criticalHint:"Mantenha atualizado. Aparece no cartÃ£o.",
          bloodType:"Tipo sanguÃ­neo",organDonor:"Doador de Ã³rgÃ£os",yes:"Sim",no:"NÃ£o",allergies:"Alergias crÃ­ticas",
          conditions:"CondiÃ§Ãµes",meds:"Medicamentos atuais",implants:"Implantes / dispositivos",
          lifeSupport:"PreferÃªncia de suporte de vida (info)",lifeSupportNote:"Apenas informativo.",
          saveHealth:"Salvar saÃºde",iceTitle:"Contatos de EmergÃªncia (ICE)",iceHint:"AtÃ© 3 contatos.",
          addContact:"Adicionar contato",triageTitle:"Status de Triagem",triageHint:"Calculado automaticamente.",
          override:"SubstituiÃ§Ã£o manual",speak:"Falar resumo",stop:"Parar",cardTitle:"CartÃ£o & QR",scanTip:"Escaneie para acesso",
          cardLink:"Link do cartÃ£o",copy:"Copiar",png:"PNG",svg:"SVG",print:"Imprimir",legend:"Cores de triagem",
          infoOnly:"Apenas apoio; verificaÃ§Ã£o clÃ­nica necessÃ¡ria.",
          privacyNote:"Dados no seu dispositivo.",
          qrNote:"QR fixo; sempre mostra dados atuais.",
          vaultTitle:"Cofre de Documentos (Em breve)",vaultHint:"Criptografia no cliente.",
          dnr:"Ordem DNR",livingWill:"Testamento vital",mpoa:"ProcuraÃ§Ã£o mÃ©dica",insurance:"Seguro",
          deleteTitle:"Excluir conta",deleteWarning:"Digite DELETE MY ACCOUNT.",deleteBtn:"Excluir conta"},
      ro:{identityTitle:"Identitate â€” InformaÈ›ii personale",identityHint:"AjutÄƒ la confirmarea identitÄƒÈ›ii.",
          fullName:"Nume complet",dob:"Data naÈ™terii",country:"ÈšarÄƒ",nationalId:"ID naÈ›ional (opÈ›ional)",
          codeLabel:"Codul tÄƒu:",genCode:"GenereazÄƒ cod",saveProfile:"SalveazÄƒ profil",
          criticalTitle:"Critic â€” Detalii medicale",criticalHint:"Èšine actualizat. Apare pe card.",
          bloodType:"Grupa sanguinÄƒ",organDonor:"Donator de organe",yes:"Da",no:"Nu",allergies:"Alergii critice",
          conditions:"AfecÈ›iuni",meds:"MedicaÈ›ie curentÄƒ",implants:"Implanturi / dispozitive",
          lifeSupport:"PreferinÈ›Äƒ suport vital (info)",lifeSupportNote:"Informativ doar.",
          saveHealth:"SalveazÄƒ datele",iceTitle:"Contacte de urgenÈ›Äƒ (ICE)",iceHint:"PÃ¢nÄƒ la 3 contacte.",
          addContact:"AdaugÄƒ contact",triageTitle:"Stare triere",triageHint:"Calcul automat.",
          override:"Suprascriere manualÄƒ",speak:"Voce: sumar",stop:"Stop",cardTitle:"Card & QR",scanTip:"ScaneazÄƒ pentru acces",
          cardLink:"Link card",copy:"CopiazÄƒ",png:"PNG",svg:"SVG",print:"PrinteazÄƒ",legend:"Culori triere",
          infoOnly:"Doar informativ; verificare medicalÄƒ necesarÄƒ.",
          privacyNote:"Datele rÄƒmÃ¢n pe dispozitiv.",
          qrNote:"QR rÄƒmÃ¢ne acelaÈ™i; aratÄƒ datele actuale.",
          vaultTitle:"Seif Documente (ÃŽn curÃ¢nd)",vaultHint:"Criptare pe client.",
          dnr:"Ordin DNR",livingWill:"Testament vital",mpoa:"Mandat medical",insurance:"Asigurare",
          deleteTitle:"È˜terge contul",deleteWarning:"TasteazÄƒ DELETE MY ACCOUNT.",deleteBtn:"È˜terge contul"},
      ar:{identityTitle:"Ø§Ù„Ù‡ÙˆÙŠØ© â€” Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©",identityHint:"ØªØ³Ø§Ø¹Ø¯ ÙÙŠ ØªØ£ÙƒÙŠØ¯ Ù‡ÙˆÙŠØªÙƒ.",
          fullName:"Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„",dob:"ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯",country:"Ø§Ù„Ø¯ÙˆÙ„Ø©",nationalId:"Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",
          codeLabel:"Ø±Ù…Ø² Ø¨Ø·Ø§Ù‚ØªÙƒ:",genCode:"Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù…Ø²",saveProfile:"Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù",
          criticalTitle:"Ø­Ø±ÙØ¬ â€” Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ­ÙŠØ©",criticalHint:"Ø£Ø¨Ù‚Ù‡Ø§ Ù…Ø­Ø¯Ø«Ø©. ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©.",
          bloodType:"ÙØµÙŠÙ„Ø© Ø§Ù„Ø¯Ù…",organDonor:"Ù…ØªØ¨Ø±Ø¹ Ø¨Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡",yes:"Ù†Ø¹Ù…",no:"Ù„Ø§",allergies:"Ø­Ø³Ø§Ø³ÙŠØ© Ø®Ø·ÙŠØ±Ø©",
          conditions:"Ø­Ø§Ù„Ø§Øª",meds:"Ø£Ø¯ÙˆÙŠØ© Ø­Ø§Ù„ÙŠØ©",implants:"Ø²Ø±Ø¹Ø§Øª / Ø£Ø¬Ù‡Ø²Ø©",
          lifeSupport:"ØªÙØ¶ÙŠÙ„ Ø¯Ø¹Ù… Ø§Ù„Ø­ÙŠØ§Ø© (Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠ)",lifeSupportNote:"Ù„Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙ‚Ø·.",
          saveHealth:"Ø­ÙØ¸ Ø§Ù„ØµØ­Ø©",iceTitle:"Ø¬Ù‡Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ (ICE)",iceHint:"Ø­ØªÙ‰ 3 Ø¬Ù‡Ø§Øª.",
          addContact:"Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø©",triageTitle:"Ø­Ø§Ù„Ø© Ø§Ù„ÙØ±Ø² Ø§Ù„Ø·Ø¨ÙŠ",triageHint:"ØªÙØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.",
          override:"ØªØ¬Ø§ÙˆØ² ÙŠØ¯ÙˆÙŠ",speak:"ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ù„Ø®Øµ",stop:"Ø¥ÙŠÙ‚Ø§Ù",cardTitle:"Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ùˆ Ø±Ù…Ø² QR",scanTip:"Ø§Ù…Ø³Ø­ Ù„Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø·Ø§Ø±Ø¦",
          cardLink:"Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©",copy:"Ù†Ø³Ø®",png:"PNG",svg:"SVG",print:"Ø·Ø¨Ø§Ø¹Ø©",legend:"Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙØ±Ø²",
          infoOnly:"Ù„Ù„Ø§Ø³ØªØ±Ø´Ø§Ø¯ ÙÙ‚Ø·Ø› ÙŠÙ„Ø²Ù… Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠ.",
          privacyNote:"Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ.",
          qrNote:"Ø±Ù…Ø² QR Ø«Ø§Ø¨Øª â€” ÙŠØ¹Ø±Ø¶ Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª.",
          vaultTitle:"Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª (Ù‚Ø±ÙŠØ¨Ø§Ù‹)",vaultHint:"ØªØ´ÙÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø².",
          dnr:"Ø£ÙˆØ§Ù…Ø± DNR",livingWill:"Ø§Ù„ÙˆØµÙŠØ© Ø§Ù„Ø·Ø¨ÙŠØ©",mpoa:"ØªÙÙˆÙŠØ¶ Ø·Ø¨ÙŠ",insurance:"Ø§Ù„ØªØ£Ù…ÙŠÙ†",
          deleteTitle:"Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨",deleteWarning:"Ø§ÙƒØªØ¨ DELETE MY ACCOUNT.",deleteBtn:"Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨"},
      hi:{identityTitle:"à¤ªà¤¹à¤šà¤¾à¤¨ â€” à¤µà¥à¤¯à¤•à¥à¤¤à¤¿à¤—à¤¤ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€",identityHint:"à¤ªà¤¹à¤šà¤¾à¤¨ à¤•à¥€ à¤ªà¥à¤·à¥à¤Ÿà¤¿ à¤®à¥‡à¤‚ à¤¸à¤¹à¤¾à¤¯à¤•.",
          fullName:"à¤ªà¥‚à¤°à¤¾ à¤¨à¤¾à¤®",dob:"à¤œà¤¨à¥à¤® à¤¤à¤¿à¤¥à¤¿",country:"à¤¦à¥‡à¤¶",nationalId:"à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¥€à¤¯ à¤†à¤ˆà¤¡à¥€ (à¤µà¥ˆà¤•à¤²à¥à¤ªà¤¿à¤•)",
          codeLabel:"à¤†à¤ªà¤•à¤¾ à¤•à¤¾à¤°à¥à¤¡ à¤•à¥‹à¤¡:",genCode:"à¤•à¥‹à¤¡ à¤¬à¤¨à¤¾à¤à¤",saveProfile:"à¤ªà¥à¤°à¥‹à¤«à¤¼à¤¾à¤‡à¤² à¤¸à¤¹à¥‡à¤œà¥‡à¤‚",
          criticalTitle:"à¤®à¤¹à¤¤à¥à¤µà¤ªà¥‚à¤°à¥à¤£ â€” à¤šà¤¿à¤•à¤¿à¤¤à¥à¤¸à¥€à¤¯ à¤µà¤¿à¤µà¤°à¤£",criticalHint:"à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤°à¤–à¥‡à¤‚. à¤•à¤¾à¤°à¥à¤¡ à¤ªà¤° à¤¦à¤¿à¤–à¥‡à¤—à¤¾à¥¤",
          bloodType:"à¤°à¤•à¥à¤¤ à¤¸à¤®à¥‚à¤¹",organDonor:"à¤…à¤‚à¤— à¤¦à¤¾à¤¤à¤¾",yes:"à¤¹à¤¾à¤",no:"à¤¨à¤¹à¥€à¤‚",allergies:"à¤—à¤‚à¤­à¥€à¤° à¤à¤²à¤°à¥à¤œà¥€",
          conditions:"à¤¸à¥à¤¥à¤¿à¤¤à¤¿à¤¯à¤¾à¤",meds:"à¤µà¤°à¥à¤¤à¤®à¤¾à¤¨ à¤¦à¤µà¤¾à¤à¤",implants:"à¤‡à¤®à¥à¤ªà¥à¤²à¤¾à¤‚à¤Ÿ/à¤¡à¤¿à¤µà¤¾à¤‡à¤¸",
          lifeSupport:"à¤œà¥€à¤µà¤¨-à¤¸à¤®à¤°à¥à¤¥à¤¨ à¤µà¤°à¥€à¤¯à¤¤à¤¾ (à¤¸à¥‚à¤šà¤¨à¤¾à¤¤à¥à¤®à¤•)",lifeSupportNote:"à¤•à¥‡à¤µà¤² à¤¸à¥‚à¤šà¤¨à¤¾ à¤¹à¥‡à¤¤à¥.",
          saveHealth:"à¤¸à¥à¤µà¤¾à¤¸à¥à¤¥à¥à¤¯ à¤¸à¤¹à¥‡à¤œà¥‡à¤‚",iceTitle:"à¤†à¤ªà¤¾à¤¤à¤•à¤¾à¤²à¥€à¤¨ à¤¸à¤‚à¤ªà¤°à¥à¤• (ICE)",iceHint:"à¤…à¤§à¤¿à¤•à¤¤à¤® 3.",
          addContact:"à¤¸à¤‚à¤ªà¤°à¥à¤• à¤œà¥‹à¤¡à¤¼à¥‡à¤‚",triageTitle:"à¤Ÿà¥à¤°à¤¾à¤¯à¥‡à¤œ à¤¸à¥à¤¥à¤¿à¤¤à¤¿",triageHint:"à¤¸à¥à¤µà¤¤à¤ƒ à¤—à¤£à¤¨à¤¾à¥¤",
          override:"à¤®à¥ˆà¤¨à¥à¤¯à¥à¤…à¤² à¤“à¤µà¤°à¤°à¤¾à¤‡à¤¡",speak:"à¤†à¤µà¤¾à¤œà¤¼: à¤¸à¤¾à¤°à¤¾à¤‚à¤¶",stop:"à¤°à¥‹à¤•à¥‡à¤‚",cardTitle:"à¤•à¤¾à¤°à¥à¤¡ à¤µ QR",scanTip:"à¤¸à¥à¤•à¥ˆà¤¨ à¤•à¤°à¥‡à¤‚",
          cardLink:"à¤•à¤¾à¤°à¥à¤¡ à¤²à¤¿à¤‚à¤•",copy:"à¤•à¥‰à¤ªà¥€",png:"PNG",svg:"SVG",print:"à¤ªà¥à¤°à¤¿à¤‚à¤Ÿ",legend:"à¤Ÿà¥à¤°à¤¾à¤¯à¥‡à¤œ à¤°à¤‚à¤—",
          infoOnly:"à¤¸à¤¿à¤°à¥à¤« à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾; à¤†à¤§à¤¿à¤•à¤¾à¤°à¤¿à¤• à¤œà¤¾à¤à¤š à¤†à¤µà¤¶à¥à¤¯à¤•à¥¤",
          privacyNote:"à¤¡à¥‡à¤Ÿà¤¾ à¤†à¤ªà¤•à¥‡ à¤¡à¤¿à¤µà¤¾à¤‡à¤¸ à¤ªà¤° à¤°à¤¹à¤¤à¤¾ à¤¹à¥ˆà¥¤",
          qrNote:"QR à¤¸à¥à¤¥à¤¿à¤° à¤¹à¥ˆ â€” à¤¹à¤®à¥‡à¤¶à¤¾ à¤¨à¤µà¥€à¤¨à¤¤à¤® à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤¦à¤¿à¤–à¤¾à¤¤à¤¾ à¤¹à¥ˆà¥¤",
          vaultTitle:"à¤¦à¤¸à¥à¤¤à¤¾à¤µà¥‡à¤œà¤¼ à¤µà¥‰à¤²à¥à¤Ÿ (à¤œà¤²à¥à¤¦)",vaultHint:"à¤•à¥à¤²à¤¾à¤‡à¤‚à¤Ÿ-à¤¸à¤¾à¤‡à¤¡ à¤à¤¨à¥à¤•à¥à¤°à¤¿à¤ªà¥à¤¶à¤¨à¥¤",
          dnr:"DNR à¤†à¤¦à¥‡à¤¶",livingWill:"à¤²à¤¿à¤µà¤¿à¤‚à¤— à¤µà¤¿à¤²",mpoa:"à¤®à¥‡à¤¡à¤¿à¤•à¤² à¤ªà¤¾à¤µà¤°",insurance:"à¤¬à¥€à¤®à¤¾",
          deleteTitle:"à¤–à¤¾à¤¤à¤¾ à¤¹à¤Ÿà¤¾à¤à¤",deleteWarning:"DELETE MY ACCOUNT à¤Ÿà¤¾à¤‡à¤ª à¤•à¤°à¥‡à¤‚à¥¤",deleteBtn:"à¤–à¤¾à¤¤à¤¾ à¤¹à¤Ÿà¤¾à¤à¤"},
      zh:{identityTitle:"èº«ä»½ â€” ä¸ªäººä¿¡æ¯",identityHint:"å¸®åŠ©æ€¥æ•‘äººå‘˜ç¡®è®¤èº«ä»½ã€‚",
          fullName:"å§“å",dob:"å‡ºç”Ÿæ—¥æœŸ",country:"å›½å®¶",nationalId:"å›½å®¶è¯ä»¶ï¼ˆå¯é€‰ï¼‰",
          codeLabel:"ä½ çš„å¡ç‰‡ä»£ç ï¼š",genCode:"ç”Ÿæˆä»£ç ",saveProfile:"ä¿å­˜èµ„æ–™",
          criticalTitle:"é‡è¦ â€” åŒ»ç–—ä¿¡æ¯",criticalHint:"ä¿æŒæœ€æ–°ã€‚æ˜¾ç¤ºåœ¨æ€¥æ•‘å¡ä¸Šã€‚",
          bloodType:"è¡€åž‹",organDonor:"å™¨å®˜æçŒ®è€…",yes:"æ˜¯",no:"å¦",allergies:"é‡è¦è¿‡æ•",
          conditions:"ç—…ç—‡",meds:"å½“å‰ç”¨è¯",implants:"æ¤å…¥/è®¾å¤‡",
          lifeSupport:"ç”Ÿå‘½æ”¯æŒåå¥½ï¼ˆä¿¡æ¯ï¼‰",lifeSupportNote:"ä»…ä¾›å‚è€ƒã€‚",
          saveHealth:"ä¿å­˜å¥åº·ä¿¡æ¯",iceTitle:"ç´§æ€¥è”ç³»äºº (ICE)",iceHint:"æœ€å¤šæ·»åŠ 3ä½è”ç³»äººã€‚",
          addContact:"æ·»åŠ è”ç³»äºº",triageTitle:"åˆ†è¯ŠçŠ¶æ€",triageHint:"è‡ªåŠ¨è®¡ç®—ï¼Œå¯æ‰‹åŠ¨è¦†ç›–ã€‚",
          override:"æ‰‹åŠ¨è¦†ç›–",speak:"æœ—è¯»æ‘˜è¦",stop:"åœæ­¢",cardTitle:"æ€¥æ•‘å¡ & äºŒç»´ç ",scanTip:"æ‰«æèŽ·å–æ€¥æ•‘ä¿¡æ¯",
          cardLink:"å¡ç‰‡é“¾æŽ¥",copy:"å¤åˆ¶",png:"PNG",svg:"SVG",print:"æ‰“å°",legend:"åˆ†è¯Šé¢œè‰²",
          infoOnly:"ä»…ä¾›å‚è€ƒï¼›éœ€å®˜æ–¹è®°å½•æ ¸å®žã€‚",
          privacyNote:"æ•°æ®ç•™åœ¨ä½ çš„è®¾å¤‡ä¸Šã€‚",
          qrNote:"äºŒç»´ç å›ºå®šä¸å˜ï¼Œå§‹ç»ˆæ˜¾ç¤ºæœ€æ–°ä¿¡æ¯ã€‚",
          vaultTitle:"æ–‡æ¡£åº“ï¼ˆå³å°†æŽ¨å‡ºï¼‰",vaultHint:"å®¢æˆ·ç«¯åŠ å¯†å­˜å‚¨ã€‚",
          dnr:"DNR æŒ‡ä»¤",livingWill:"ç”Ÿå‰é¢„å˜±",mpoa:"åŒ»ç–—ä»£ç†",insurance:"ä¿é™©",
          deleteTitle:"åˆ é™¤è´¦æˆ·",deleteWarning:"è¾“å…¥ DELETE MY ACCOUNT ä»¥å¯ç”¨ã€‚",deleteBtn:"åˆ é™¤è´¦æˆ·"}
    };

    const langSel = document.getElementById('lang');
    function applyI18n(){
      const L = t[langSel.value] || t.en;
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key = el.getAttribute('data-i18n');
        if(L[key]) el.textContent = L[key];
      });
      document.documentElement.dir = langSel.value==='ar' ? 'rtl' : 'ltr';
    }
    langSel.addEventListener('change', ()=>{
      localStorage.setItem('myqer_lang', langSel.value);
      applyI18n();
      updateVoiceLocale();
    });
    // restore saved language
    (()=>{
      const saved = localStorage.getItem('myqer_lang');
      if(saved && t[saved]) { langSel.value = saved; applyI18n(); }
    })();

    // ------- Auth / session -------
    const sb = window.sb; // single source of truth
    let session, user, profile={}, health={}, ice=[];
    const loading = document.getElementById('loading');
    const dash = document.getElementById('dash');
    const errorBox = document.getElementById('errorBox');
    const errorMsg = document.getElementById('errorMsg');

    async function ensureSession(){
      const { data:{ session:s } } = await sb.auth.getSession();
      if(!s){ location.replace('/'); return; }
      session = s; user = s.user;
    }

    // ------- Load / Save helpers -------
    async function loadAll(){
      // Profile
      let { data:p, error:pe } = await sb.from('profiles').select('*').eq('id', user.id).single();
      if(pe && pe.code==='PGRST116'){ // not found
        p = { id:user.id, email:user.email, code:null };
        await sb.from('profiles').insert(p).select().single().then(res=>{p=res.data});
      } else if(pe){ throw pe; }
      profile = p||{};

      // Health
      let { data:h, error:he } = await sb.from('health_profiles').select('*').eq('user_id', user.id).single();
      if(he && he.code==='PGRST116'){ h = {}; }
      else if(he){ throw he; }
      health = h||{};

      // ICE
      const { data:ic, error:ie } = await sb.from('ice_contacts').select('*').eq('user_id', user.id).order('created_at');
      if(ie){ throw ie; }
      ice = ic||[];
    }

    // ------- Renderers -------
    const profileForm = document.getElementById('profileForm');
    const healthForm  = document.getElementById('healthForm');
    const iceList     = document.getElementById('iceList');
    const codeText    = document.getElementById('codeText');
    const codeUnderQR = document.getElementById('codeUnderQR');
    const cardUrlEl   = document.getElementById('cardUrl');
    const qrStatus    = document.getElementById('qrStatus');
    const triagePill  = document.getElementById('triagePill');
    const triageOverride = document.getElementById('triageOverride');

    function renderProfile(){
      const f = profileForm;
      f.full_name.value     = profile.full_name || '';
      f.date_of_birth.value = profile.date_of_birth || '';
      f.country.value       = profile.country || '';
      f.national_id.value   = profile.national_id || '';
      codeText.textContent  = profile.code || 'â€”';
      const link = profile.code ? `${location.origin}/functions/v1/card?code=${encodeURIComponent(profile.code)}` : '';
      cardUrlEl.value = link;
      codeUnderQR.textContent = profile.code || 'â€”';
    }

    function renderHealth(){
      const f = healthForm;
      f.blood_type.value      = health.blood_type || '';
      f.organ_donor.value     = (health.organ_donor===true||health.organ_donor==='yes') ? 'yes' : (health.organ_donor==='no'? 'no' : '');
      f.allergies.value       = health.allergies || '';
      f.conditions.value      = health.conditions || '';
      f.meds.value            = health.meds || '';
      f.implants.value        = health.implants || '';
      f.life_support_pref.value = health.life_support_pref || '';
    }

    function renderIce(){
      if(!ice.length){
        iceList.innerHTML = `<div class="text-slate-500 text-sm">No contacts yet.</div>`;
        return;
      }
      iceList.innerHTML = ice.map(c=>`
        <div class="border rounded-lg p-3">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
            <input class="border rounded-md px-3 py-2" placeholder="Name" value="${c.name||''}" data-id="${c.id}" data-field="name">
            <input class="border rounded-md px-3 py-2" placeholder="Relationship" value="${c.relation||''}" data-id="${c.id}" data-field="relation">
            <div class="flex gap-2">
              <input class="border rounded-md px-3 py-2 flex-1" placeholder="Phone" value="${c.phone||''}" data-id="${c.id}" data-field="phone">
              <button class="btn px-3 py-2 border text-sm" data-del="${c.id}">ðŸ—‘</button>
            </div>
          </div>
        </div>
      `).join('');
    }

    function computeTriage(){
      // Manual override first
      const ov = triageOverride.value;
      if(ov) return ov;

      // Heuristic
      const pref = (health.life_support_pref||'').toLowerCase();
      if(pref.includes('dnr') || pref.includes('comfort')) return 'black';

      const severe = (health.allergies||'').toLowerCase().includes('anaphyl') ||
                     (health.conditions||'').toLowerCase().includes('severe');
      if(severe) return 'red';

      const hasCond = !!(health.conditions||'').trim();
      if(hasCond) return 'amber';

      return 'green';
    }

    function applyTriage(){
      const level = computeTriage();
      const map = {
        green:{text:'GREEN', color:'#16a34a'},
        amber:{text:'AMBER', color:'#f59e0b'},
        red:{text:'RED', color:'#ef4444'},
        black:{text:'BLACK', color:'#111827'},
      };
      const v = map[level]||map.green;
      triagePill.style.border = '1px solid ' + v.color + '55';
      triagePill.style.color = v.color;
      triagePill.textContent = v.text + (level==='green'?' â€” Standard':'' );
    }

    function renderQR(){
      if(!profile.code){
        qrStatus.textContent = 'No code yet';
        const ctx = document.getElementById('qrCanvas').getContext('2d');
        ctx.clearRect(0,0,200,200);
        return;
      }
      const url = `${location.origin}/functions/v1/card?code=${encodeURIComponent(profile.code)}`;
      qrStatus.textContent = '';
      QRCode.toCanvas(document.getElementById('qrCanvas'), url, {width:200, margin:2}, err=>{
        if(err){ qrStatus.textContent = 'QR error'; }
      });
    }

    // ------- Save handlers -------
    profileForm.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const fd = new FormData(profileForm);
      const data = {
        id:user.id, email:user.email,
        full_name: fd.get('full_name')||null,
        date_of_birth: fd.get('date_of_birth')||null,
        country: fd.get('country')||null,
        national_id: fd.get('national_id')||null,
        code: profile.code || null
      };
      const { error } = await sb.from('profiles').upsert(data);
      if(error) return showToast(error.message,'err');
      profile = { ...profile, ...data };
      renderProfile(); renderQR();
      showToast('Profile saved','ok');
    });

    document.getElementById('genCode').addEventListener('click', async ()=>{
      if(profile.code){ showToast('Code already exists','warn'); return; }
      const newCode = 'MYQER-' + Math.random().toString(36).slice(2, 9).toUpperCase();
      const { error } = await sb.from('profiles').update({ code:newCode }).eq('id', user.id);
      if(error) return showToast(error.message,'err');
      profile.code = newCode;
      renderProfile(); renderQR();
      showToast('Code generated','ok');
    });

    healthForm.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const fd = new FormData(healthForm);
      const data = {
        user_id: user.id,
        blood_type: fd.get('blood_type')||null,
        organ_donor: fd.get('organ_donor')==='yes' ? true : (fd.get('organ_donor')==='no' ? false : null),
        allergies: fd.get('allergies')||null,
        conditions: fd.get('conditions')||null,
        meds: fd.get('meds')||null,
        implants: fd.get('implants')||null,
        life_support_pref: fd.get('life_support_pref')||null
      };
      const { error } = await sb.from('health_profiles').upsert(data);
      if(error) return showToast(error.message,'err');
      health = { ...health, ...data };
      applyTriage();
      showToast('Health saved','ok');
    });

    // ICE interactivity
    document.getElementById('addIce').addEventListener('click', async ()=>{
      if(ice.length>=3){ showToast('Maximum 3 contacts','warn'); return; }
      const { data, error } = await sb.from('ice_contacts').insert({user_id:user.id,name:'',relation:'',phone:''}).select().single();
      if(error) return showToast(error.message,'err');
      ice.push(data); renderIce();
    });

    // Debounced update helper
    const debouncers = {};
    function debounceSave(id, fn, ms=400){
      clearTimeout(debouncers[id]);
      debouncers[id] = setTimeout(fn, ms);
    }

    iceList.addEventListener('input', (e)=>{
      const id = e.target.dataset.id; const field = e.target.dataset.field;
      if(!id||!field) return;
      const val = e.target.value;
      debounceSave(`${id}:${field}`, async ()=>{
        const { error } = await sb.from('ice_contacts').update({ [field]:val }).eq('id', id);
        if(error) showToast('Update failed','err');
      });
      const row = ice.find(x=>String(x.id)===String(id)); if(row) row[field]=val;
    });

    iceList.addEventListener('click', async (e)=>{
      const del = e.target.dataset.del;
      if(!del) return;
      if(!confirm('Delete this contact?')) return;
      const { error } = await sb.from('ice_contacts').delete().eq('id', del);
      if(error) return showToast(error.message,'err');
      ice = ice.filter(x=>String(x.id)!==String(del)); renderIce();
    });

    // ------- Voice (Web Speech API) -------
    let voiceLang = 'en-US';
    function updateVoiceLocale(){
      const map = {en:'en-US',es:'es-ES',fr:'fr-FR',de:'de-DE',it:'it-IT',pt:'pt-PT',ro:'ro-RO',ar:'ar-SA',hi:'hi-IN',zh:'zh-CN'};
      voiceLang = map[langSel.value] || 'en-US';
    }
    updateVoiceLocale();

    function buildSummary(){
      const L = t[langSel.value]||t.en;
      const n = profile.full_name || '';
      const a = (health.allergies||'').trim() || L.allergies;
      const m = (health.meds||'').trim() || L.meds;
      const c = (health.conditions||'').trim() || L.conditions;
      const bt = health.blood_type || 'â€”';
      return `${n}. ${L.bloodType}: ${bt}. ${L.allergies}: ${a}. ${L.conditions}: ${c}. ${L.meds}: ${m}.`;
    }

    document.getElementById('speak').addEventListener('click', ()=>{
      try{ speechSynthesis.cancel(); }catch(_){}
      const utter = new SpeechSynthesisUtterance(buildSummary());
      utter.lang = voiceLang;
      speechSynthesis.speak(utter);
    });
    document.getElementById('stopSpeak').addEventListener('click', ()=>{
      try{ speechSynthesis.cancel(); }catch(_){}
    });

    // ------- QR actions -------
    document.getElementById('copyLink').addEventListener('click', async ()=>{
      if(cardUrlEl.value){ await navigator.clipboard.writeText(cardUrlEl.value); showToast('Copied','ok'); }
    });
    document.getElementById('dlPNG').addEventListener('click', ()=>{
      const canvas = document.getElementById('qrCanvas');
      if(!profile.code) return;
      const link = document.createElement('a');
      link.download = 'myqer-qr.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    });
    document.getElementById('dlSVG').addEventListener('click', ()=>{
      if(!profile.code) return;
      // Convert existing canvas PNG into an SVG wrapper (simple portable export)
      const png = document.getElementById('qrCanvas').toDataURL();
      const svg = `<svg xmlns="http://www.w3.org/2000/svg" width="512" height="512"><rect width="100%" height="100%" fill="#fff"/><image href="${png}" x="0" y="0" height="512" width="512"/></svg>`;
      const blob = new Blob([svg], {type:'image/svg+xml'});
      const a = document.createElement('a');
      a.download = 'myqer-qr.svg';
      a.href = URL.createObjectURL(blob);
      a.click();
      setTimeout(()=>URL.revokeObjectURL(a.href), 1200);
    });
    document.getElementById('printQR').addEventListener('click', ()=>{
      if(!profile.code) return;
      const w = window.open('','_blank','width=360,height=480');
      const img = document.getElementById('qrCanvas').toDataURL();
      const link = cardUrlEl.value || '';
      const code = profile.code || '';
      w.document.write(`
        <html><head><title>Print Emergency Card</title>
        <style>body{font-family:system-ui;margin:0} .wrap{display:flex;align-items:center;justify-content:center;height:100vh}</style>
        </head><body><div class="wrap">
          <div style="text-align:center">
            <img src="${img}" style="width:280px;height:280px;border:2px solid #c62828;border-radius:12px"/><br/>
            <div style="margin-top:8px;font-family:monospace">${code}</div>
            <div style="font-size:12px;color:#475569">${link}</div>
          </div>
        </div></body></html>
      `);
      w.document.close(); w.focus(); w.print();
    });

    // ------- Logout -------
    document.getElementById('logoutBtn').addEventListener('click', async ()=>{
      try { await sb.auth.signOut(); } catch(e) { console.error(e); }
      location.replace('/');
    });

    // ------- Delete account (Edge Function preferred) -------
    const deleteBtn = document.getElementById('deleteBtn');
    const deletePhrase = document.getElementById('deletePhrase');
    const deleteNote = document.getElementById('deleteNote');

    deletePhrase.addEventListener('input', ()=>{
      deleteBtn.disabled = deletePhrase.value.trim().toUpperCase() !== 'DELETE MY ACCOUNT';
    });

    deleteBtn.addEventListener('click', async ()=>{
      if(!confirm('This will permanently delete your account and data. Continue?')) return;
      deleteBtn.disabled = true;
      deleteNote.textContent = 'Processingâ€¦';
      try{
        const { data:{ session:s } } = await sb.auth.getSession();
        const token = s?.access_token;
        const resp = await fetch(`${location.origin}/functions/v1/delete-account`, {
          method:'POST',
          headers:{ Authorization: token ? `Bearer ${token}` : '' }
        });
        if(!resp.ok) throw new Error('Delete endpoint not available');
        deleteNote.textContent = 'Deleted. Signing outâ€¦';
        setTimeout(async ()=>{ await sb.auth.signOut(); location.replace('/'); }, 800);
      }catch(e){
        deleteNote.textContent = 'Automatic deletion not available. Please enable the secured Edge Function.';
        deleteBtn.disabled = false;
      }
    });

    // ------- Tiny toast -------
    function showToast(msg,type='ok'){
      const el = document.createElement('div');
      el.className = `fixed top-4 right-4 z-[1000] px-4 py-2 rounded-md text-white shadow ${type==='ok'?'bg-emerald-600':type==='warn'?'bg-amber-600':'bg-red-600'}`;
      el.textContent = msg;
      document.body.appendChild(el);
      setTimeout(()=>el.remove(), 2200);
    }

  <!-- ------- Init sequence (final, wrapped correctly) ------- -->
<script>
  /* assumes you already pasted the initSupabase() function + SUPABASE_URL/KEY earlier in this file */

  // Elements used during boot and error states
  const loading  = document.getElementById('loading');
  const dash     = document.getElementById('dash');
  const errorBox = document.getElementById('errorBox');
  const errorMsg = document.getElementById('errorMsg');

  // Boot the dashboard
  (async () => {
    try {
      // 1) Ensure Supabase client exists (works on iOS Safari too)
      await initSupabase();
      const sb = window.sb;
      if (!sb) throw new Error('Supabase client not created');

      // 2) Session guard
      const { data: { session } } = await sb.auth.getSession();
      if (!session) { window.location.replace('/'); return; }

      // 3) Load data from DB
      await loadAll();

      // 4) Render UI
      renderProfile();
      renderHealth();
      renderIce();
      renderQR();
      applyTriage();
      applyI18n();

      // 5) Reveal dashboard
      loading.classList.add('hidden');
      dash.classList.remove('hidden');
    } catch (e) {
      console.error(e);
      loading.classList.add('hidden');
      errorMsg.textContent = e.message || 'Unknown error';
      errorBox.classList.remove('hidden');
    }
  })();

  // Listeners (keep only one copy)
  document.getElementById('triageOverride')
    ?.addEventListener('change', applyTriage);

  document.getElementById('logoutBtn')
    ?.addEventListener('click', async () => {
      try { await window.sb.auth.signOut(); } catch (_) {}
      window.location.replace('/');
    });
</script>

<!-- (optional) Service worker registration -->
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/myqer_service_worker.js').catch(()=>{});
  }
</script>
</body>
</html>
