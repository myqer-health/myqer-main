<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MYQER - Your Medical Essentials, One Scan Away</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #fafafa 0%, #ffffff 100%);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(220, 38, 127, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 40px;
            z-index: 100;
        }

        .logo-sleek {
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(135deg, #dc267f 0%, #ff453a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }

        .hamburger-menu {
            position: relative;
        }

        .hamburger-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .hamburger-btn:hover {
            background: rgba(220, 38, 127, 0.1);
        }

        .hamburger-icon {
            width: 24px;
            height: 18px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .hamburger-line {
            width: 100%;
            height: 2px;
            background: #dc267f;
            border-radius: 1px;
            transition: all 0.3s ease;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(220, 38, 127, 0.1);
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            margin-top: 8px;
        }

        .dropdown-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-section {
            padding: 16px 0;
            border-bottom: 1px solid rgba(220, 38, 127, 0.1);
        }

        .dropdown-section:last-child {
            border-bottom: none;
        }

        .dropdown-item {
            display: block;
            padding: 8px 20px;
            color: #333;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .dropdown-item:hover {
            background: rgba(220, 38, 127, 0.05);
            color: #dc267f;
        }

        .language-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4px;
            padding: 8px 12px;
        }

        .language-item {
            padding: 6px 8px;
            font-size: 0.8rem;
            text-align: center;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #666;
        }

        .language-item:hover {
            background: rgba(220, 38, 127, 0.1);
            color: #dc267f;
        }

        .language-item.active {
            background: #dc267f;
            color: white;
        }

        .auth-buttons {
            display: flex;
            gap: 8px;
        }

        .auth-btn {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            outline: none;
        }

        .login-btn {
            background: transparent;
            color: #666;
            border: 1px solid rgba(220, 38, 127, 0.2);
        }

        .login-btn:hover {
            background: rgba(220, 38, 127, 0.05);
            color: #dc267f;
        }

        .signup-btn {
            background: linear-gradient(135deg, #dc267f, #ff453a);
            color: white;
            border: 1px solid transparent;
        }

        .signup-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(220, 38, 127, 0.2);
        }

        .main-container {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 80px 40px 0;
        }

        .center-content {
            text-align: center;
            max-width: 600px;
        }

        .brand-hero {
            font-size: 5rem;
            font-weight: 900;
            background: linear-gradient(135deg, #dc267f 0%, #ff453a 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            letter-spacing: -2px;
            animation: brandFloat 4s ease-in-out infinite;
        }

        .pronunciation-hint {
            font-size: 0.9rem;
            color: #999;
            font-style: italic;
            margin-bottom: 16px;
            font-weight: 300;
        }

        .smart-health-subtitle {
            font-size: 1.2rem;
            color: #dc267f;
            font-weight: 600;
            margin-bottom: 32px;
            letter-spacing: 0.5px;
        }

        @keyframes brandFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        .tagline {
            font-size: 1.8rem;
            color: #666;
            margin-bottom: 16px;
            font-weight: 300;
            letter-spacing: -0.5px;
        }

        .qr-info-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 32px;
            margin-bottom: 48px;
            padding: 32px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            border: 1px solid rgba(220, 38, 127, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(220, 38, 127, 0.1);
        }

        .qr-pattern {
            position: relative;
            width: 120px;
            height: 120px;
            background: white;
            border: 3px solid #dc267f;
            border-radius: 12px;
            flex-shrink: 0;
        }

        .qr-corner {
            position: absolute;
            width: 20px;
            height: 20px;
            border: 3px solid #dc267f;
        }

        .qr-corner.top-left {
            top: 8px;
            left: 8px;
            border-right: none;
            border-bottom: none;
        }

        .qr-corner.top-right {
            top: 8px;
            right: 8px;
            border-left: none;
            border-bottom: none;
        }

        .qr-corner.bottom-left {
            bottom: 8px;
            left: 8px;
            border-right: none;
            border-top: none;
        }

        .qr-corner.bottom-right {
            bottom: 8px;
            right: 8px;
            border-left: none;
            border-top: none;
        }

        .qr-dots {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            width: 60px;
            height: 60px;
        }

        .dot {
            width: 8px;
            height: 8px;
            background: #dc267f;
            border-radius: 2px;
            opacity: 0.7;
        }

        .dot:nth-child(2n) {
            opacity: 0.4;
        }

        .dot:nth-child(3n) {
            opacity: 0.8;
        }

        .qr-text-content {
            flex: 1;
            text-align: left;
        }

        .qr-text-content .tagline {
            font-size: 1.4rem;
            color: #999;
            margin-bottom: 12px;
            font-weight: 600;
            letter-spacing: -0.3px;
        }

        .qr-text-content .subtitle {
            font-size: 1rem;
            color: #666;
            margin-bottom: 0;
            font-weight: 400;
            line-height: 1.5;
        }

        .center-auth-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
        }

        .center-auth-btn {
            padding: 16px 32px;
            border-radius: 30px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            outline: none;
        }

        .center-auth-btn.login-btn {
            background: transparent;
            color: #dc267f;
            border: 2px solid #dc267f;
        }

        .center-auth-btn.login-btn:hover {
            background: #dc267f;
            color: white;
            transform: translateY(-2px);
        }

        .center-auth-btn.signup-btn {
            background: linear-gradient(135deg, #dc267f, #ff453a);
            color: white;
            border: 2px solid transparent;
        }

        .center-auth-btn.signup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 38, 127, 0.3);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: white;
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 400px;
            transform: translateY(30px);
            transition: all 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .modal-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }

        .modal-subtitle {
            color: #666;
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            outline: none;
        }

        .form-input:focus {
            border-color: #dc267f;
            box-shadow: 0 0 0 3px rgba(220, 38, 127, 0.1);
        }

        .form-button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #dc267f, #ff453a);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 16px;
        }

        .form-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 38, 127, 0.3);
        }

        .form-switch {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
        }

        .form-switch a {
            color: #dc267f;
            text-decoration: none;
            font-weight: 600;
        }

        .form-switch a:hover {
            text-decoration: underline;
        }

        .close-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #999;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        /* Tablet styles */
        @media (max-width: 1024px) {
            .main-container {
                padding: 80px 32px 32px;
            }

            .brand-hero {
                font-size: 4rem;
            }

            .qr-info-container {
                gap: 24px;
                padding: 28px;
            }

            .qr-pattern {
                width: 110px;
                height: 110px;
            }

            .qr-text-content .tagline {
                font-size: 1.3rem;
            }
        }

        /* Mobile landscape */
        @media (max-width: 768px) {
            .header {
                padding: 12px 20px;
                height: 70px;
            }

            .main-container {
                padding: 70px 20px 20px;
                min-height: calc(100vh - 70px);
            }

            .brand-hero {
                font-size: 3.5rem;
                letter-spacing: -1px;
            }

            .pronunciation-hint {
                font-size: 0.85rem;
            }

            .smart-health-subtitle {
                font-size: 1.1rem;
                margin-bottom: 24px;
            }

            .qr-info-container {
                flex-direction: column;
                gap: 20px;
                padding: 24px 20px;
                margin-bottom: 32px;
            }

            .qr-pattern {
                width: 100px;
                height: 100px;
            }

            .qr-text-content {
                text-align: center;
            }

            .qr-text-content .tagline {
                font-size: 1.2rem;
                margin-bottom: 8px;
            }

            .qr-text-content .subtitle {
                font-size: 0.95rem;
            }

            .center-auth-buttons {
                flex-direction: column;
                gap: 12px;
                width: 100%;
            }

            .center-auth-btn {
                width: 100%;
                padding: 14px 24px;
                font-size: 0.95rem;
            }

            .modal {
                width: 95%;
                padding: 32px 24px;
                margin: 16px;
            }

            .modal-title {
                font-size: 1.6rem;
            }
        }

        /* Mobile portrait */
        @media (max-width: 480px) {
            .header {
                padding: 12px 16px;
                height: 65px;
            }

            .logo-sleek {
                font-size: 1.6rem;
            }

            .main-container {
                padding: 65px 16px 16px;
                min-height: calc(100vh - 65px);
            }

            .center-content {
                max-width: 100%;
            }

            .brand-hero {
                font-size: 2.8rem;
                margin-bottom: 6px;
            }

            .pronunciation-hint {
                font-size: 0.8rem;
                margin-bottom: 12px;
            }

            .smart-health-subtitle {
                font-size: 1rem;
                margin-bottom: 20px;
            }

            .qr-info-container {
                padding: 20px 16px;
                margin-bottom: 28px;
                border-radius: 16px;
            }

            .qr-pattern {
                width: 90px;
                height: 90px;
            }

            .qr-corner {
                width: 16px;
                height: 16px;
                border-width: 2px;
            }

            .qr-corner.top-left,
            .qr-corner.top-right {
                top: 6px;
            }

            .qr-corner.bottom-left,
            .qr-corner.bottom-right {
                bottom: 6px;
            }

            .qr-corner.top-left,
            .qr-corner.bottom-left {
                left: 6px;
            }

            .qr-corner.top-right,
            .qr-corner.bottom-right {
                right: 6px;
            }

            .qr-dots {
                width: 50px;
                height: 50px;
                gap: 6px;
            }

            .dot {
                width: 6px;
                height: 6px;
            }

            .qr-text-content .tagline {
                font-size: 1.1rem;
                line-height: 1.3;
            }

            .qr-text-content .subtitle {
                font-size: 0.9rem;
                line-height: 1.4;
            }

            .center-auth-btn {
                padding: 12px 20px;
                font-size: 0.9rem;
                border-radius: 25px;
            }

            .dropdown-menu {
                min-width: 180px;
                right: -8px;
            }

            .language-grid {
                grid-template-columns: 1fr 1fr;
                gap: 3px;
                padding: 6px 8px;
            }

            .language-item {
                padding: 5px 6px;
                font-size: 0.75rem;
            }

            .modal {
                width: 96%;
                padding: 28px 20px;
                border-radius: 16px;
            }

            .modal-title {
                font-size: 1.5rem;
            }

            .form-input {
                padding: 10px 14px;
                font-size: 0.95rem;
            }

            .form-button {
                padding: 12px;
                font-size: 0.95rem;
            }
        }

        /* Very small screens */
        @media (max-width: 360px) {
            .brand-hero {
                font-size: 2.4rem;
            }

            .qr-info-container {
                padding: 16px 12px;
            }

            .qr-pattern {
                width: 80px;
                height: 80px;
            }

            .qr-text-content .tagline {
                font-size: 1rem;
            }

            .qr-text-content .subtitle {
                font-size: 0.85rem;
            }

            .modal {
                padding: 24px 16px;
            }
        }

        /* Landscape orientation adjustments */
        @media (max-height: 600px) and (orientation: landscape) {
            .main-container {
                padding: 60px 20px 20px;
            }

            .brand-hero {
                font-size: 2.5rem;
                margin-bottom: 4px;
            }

            .pronunciation-hint {
                margin-bottom: 8px;
            }

            .smart-health-subtitle {
                margin-bottom: 16px;
            }

            .qr-info-container {
                margin-bottom: 20px;
                padding: 16px;
            }

            .center-auth-buttons {
                flex-direction: row;
                gap: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-sleek">MYQER™</div>
        <div class="hamburger-menu">
            <button class="hamburger-btn" onclick="toggleDropdown()">
                <div class="hamburger-icon">
                    <div class="hamburger-line"></div>
                    <div class="hamburger-line"></div>
                    <div class="hamburger-line"></div>
                </div>
            </button>
            <div class="dropdown-menu" id="dropdownMenu">
                <div class="dropdown-section">
                    <a href="#" class="dropdown-item" data-translate="about">About</a>
                    <a href="#" class="dropdown-item" data-translate="contact">Contact</a>
                    <a href="#" class="dropdown-item" data-translate="privacy">Privacy</a>
                    <a href="#" class="dropdown-item" data-translate="terms">Terms</a>
                </div>
                <div class="dropdown-section">
                    <div class="language-grid">
                        <div class="language-item active" onclick="changeLanguage('en')">English</div>
                        <div class="language-item" onclick="changeLanguage('es')">Español</div>
                        <div class="language-item" onclick="changeLanguage('fr')">Français</div>
                        <div class="language-item" onclick="changeLanguage('de')">Deutsch</div>
                        <div class="language-item" onclick="changeLanguage('it')">Italiano</div>
                        <div class="language-item" onclick="changeLanguage('pt')">Português</div>
                        <div class="language-item" onclick="changeLanguage('ro')">Română</div>
                        <div class="language-item" onclick="changeLanguage('ar')">العربية</div>
                        <div class="language-item" onclick="changeLanguage('zh')">中文</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="main-container">
        <div class="center-content">
            <div class="brand-hero">MYQER™</div>
            <div class="pronunciation-hint" data-translate="pronunciation">pronounced "my care"</div>
            <div class="smart-health-subtitle" data-translate="subtitle">Free smart health & emergency QR</div>
            <div class="qr-info-container">
                <div class="qr-pattern">
                    <div class="qr-corner top-left"></div>
                    <div class="qr-corner top-right"></div>
                    <div class="qr-corner bottom-left"></div>
                    <div class="qr-corner bottom-right"></div>
                    <div class="qr-dots">
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                    </div>
                </div>
                <div class="qr-text-content">
                    <div class="tagline" data-translate="tagline">Your medical essentials—one scan away.</div>
                    <div class="subtitle" data-translate="description">When seconds count, MYQER instantly shows first responders your vital information.</div>
                </div>
            </div>
            <div class="center-auth-buttons">
                <button class="center-auth-btn login-btn" onclick="openModal('login')" data-translate="login">Login</button>
                <button class="center-auth-btn signup-btn" onclick="openModal('signup')" data-translate="signup">Sign Up</button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <div class="modal-header">
                <div class="modal-title">Welcome Back</div>
                <div class="modal-subtitle">Sign in to your MYQER account</div>
            </div>
            <form onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" required>
                </div>
                <button type="submit" class="form-button">Sign In</button>
                <div class="form-switch">
                    Don't have an account? <a href="#" onclick="switchModal('signup')">Sign up</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal-overlay" id="signupModal">
        <div class="modal">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <div class="modal-header">
                <div class="modal-title">Join MYQER</div>
                <div class="modal-subtitle">Create your account in minutes</div>
            </div>
            <form onsubmit="handleSignup(event)">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" required>
                </div>
                <button type="submit" class="form-button">Create Account</button>
                <div class="form-switch">
                    Already have an account? <a href="#" onclick="switchModal('login')">Sign in</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Supabase SDK (single copy) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- (Kept) QRCode lib -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>

    <!-- Integrated wiring -->
    <script>
    // ---------- Config (edit only these if needed) ----------
    const SUPABASE_URL      = "https://dmntmhkncldgynufajei.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRtbnRtaGtuY2xkZ3ludWZhamVpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY4MzQ2MzUsImV4cCI6MjA3MjQxMDYzNX0.6DzOSb0xu5bp4g2wKy3SNtEEuSQavs_ohscyawvPmrY";
    const DASHBOARD_URL     = "/dashboard.html"; // where to go after sign-in
    // -------------------------------------------------------

    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // ------------ UI helpers (unchanged behaviors) ------------
    function toggleDropdown(){ const d=document.getElementById('dropdownMenu'); if(d) d.classList.toggle('active'); }
    function openModal(type){ closeModal(); setTimeout(()=>{ const m=document.getElementById(type+'Modal'); if(m) m.classList.add('active'); },100); }
    function closeModal(){ document.querySelectorAll('.modal-overlay').forEach(m=>m.classList.remove('active')); }
    function switchModal(type){ closeModal(); setTimeout(()=>openModal(type),300); }

    function toast(msg){ alert(msg); } // simple drop-in; swap for your own toast if you like

    // Close dropdown when clicking outside
    document.addEventListener('click',(e)=>{
      const dropdown = document.getElementById('dropdownMenu');
      const hamburger = document.querySelector('.hamburger-menu');
      if (hamburger && !hamburger.contains(e.target) && dropdown) dropdown.classList.remove('active');
    });
    // Close modals (overlay/Escape)
    document.querySelectorAll('.modal-overlay').forEach(ov=>{
      ov.addEventListener('click',e=>{ if(e.target===ov) closeModal(); });
    });
    document.addEventListener('keydown',e=>{ if(e.key==='Escape') closeModal(); });

    // ----------------- Auth wiring -----------------
    async function goIfSignedIn() {
      const { data: { session } } = await sb.auth.getSession();
      if (session) window.location.href = DASHBOARD_URL;
    }
    goIfSignedIn();

    // Keep page in sync if auth state changes in another tab
    sb.auth.onAuthStateChange((_event, session) => {
      if (session) window.location.href = DASHBOARD_URL;
    });

    // Login handler (email+password only)
    async function handleLogin(event){
      event.preventDefault();
      const form   = event.target;
      const button = form.querySelector('.form-button');
      const email  = form.querySelector('input[type="email"]').value.trim();
      const pass   = form.querySelector('input[type="password"]').value;

      const original = button.textContent;
      button.textContent = 'Signing in…';
      button.disabled = true;

      try {
        const { error } = await sb.auth.signInWithPassword({ email, password: pass });
        if (error) throw error;
        window.location.href = DASHBOARD_URL;
      } catch (err) {
        toast('Login failed: ' + (err.message || err));
      } finally {
        button.textContent = original;
        button.disabled = false;
      }
    }

    // Signup handler (email+password only)
    async function handleSignup(event){
      event.preventDefault();
      const form   = event.target;
      const button = form.querySelector('.form-button');
      const name   = form.querySelector('input[type="text"]').value.trim();
      const email  = form.querySelector('input[type="email"]').value.trim();
      const pass   = form.querySelector('input[type="password"]').value;

      const original = button.textContent;
      button.textContent = 'Creating account…';
      button.disabled = true;

      try {
        const { error } = await sb.auth.signUp({
          email, password: pass,
          options: { data: { full_name: name } }
        });
        if (error) throw error;

        // If Email Confirmations are ON in Supabase, there’s no session until user verifies.
        const { data: s } = await sb.auth.getSession();
        if (s?.session) {
          window.location.href = DASHBOARD_URL;
        } else {
          closeModal();
          toast('Account created. Please confirm your email to finish sign up.');
        }
      } catch (err) {
        toast('Signup failed: ' + (err.message || err));
      } finally {
        button.textContent = original;
        button.disabled = false;
      }
    }

    // Expose handlers to inline HTML forms
    window.handleLogin  = handleLogin;
    window.handleSignup = handleSignup;

    // ----------------- Language switcher -----------------
    const translations = {
      en:{pronunciation:'pronounced "my care"',subtitle:'Free smart health & emergency QR',tagline:'Your medical essentials—one scan away.',description:'When seconds count, MYQER instantly shows first responders your vital information.',login:'Login',signup:'Sign Up',about:'About',contact:'Contact',privacy:'Privacy',terms:'Terms'},
      es:{pronunciation:'pronunciado "mi cuidado"',subtitle:'QR gratuito inteligente de salud y emergencia',tagline:'Tus elementos médicos esenciales—a un escaneo de distancia.',description:'Cuando los segundos cuentan, MYQER muestra instantáneamente tu información vital a los primeros auxilios.',login:'Iniciar Sesión',signup:'Registrarse',about:'Acerca de',contact:'Contacto',privacy:'Privacidad',terms:'Términos'},
      fr:{pronunciation:'prononcé "mon soin"',subtitle:'QR intelligent de santé et urgence',tagline:'Vos éléments médicaux essentiels—à un scan près.',description:'Quand chaque seconde compte, MYQER montre instantanément vos informations vitales aux premiers secours.',login:'Connexion',signup:'S’inscrire',about:'À propos',contact:'Contact',privacy:'Confidentialité',terms:'Conditions'},
      de:{pronunciation:'ausgesprochen "meine Pflege"',subtitle:'Intelligenter Gesundheits- und Notfall-QR',tagline:'Ihre medizinischen Grundlagen—einen Scan entfernt.',description:'Wenn Sekunden zählen, zeigt MYQER Ersthelfern sofort Ihre wichtigen Informationen.',login:'Anmelden',signup:'Registrieren',about:'Über uns',contact:'Kontakt',privacy:'Datenschutz',terms:'Bedingungen'},
      it:{pronunciation:'pronunciato "la mia cura"',subtitle:'QR intelligente per salute ed emergenze',tagline:'I tuoi elementi medici essenziali—a una scansione di distanza.',description:'Quando i secondi contano, MYQER mostra istantaneamente le tue informazioni vitali ai primi soccorsi.',login:'Accedi',signup:'Registrati',about:'Chi siamo',contact:'Contatto',privacy:'Privacy',terms:'Termini'},
      pt:{pronunciation:'pronunciado "meu cuidado"',subtitle:'QR inteligente de saúde e emergência',tagline:'Seus elementos médicos essenciais—a um scan de distância.',description:'Quando segundos importam, MYQER mostra instantaneamente suas informações vitais aos socorristas.',login:'Entrar',signup:'Cadastrar',about:'Sobre',contact:'Contato',privacy:'Privacidade',terms:'Termos'},
      ro:{pronunciation:'pronunțat "grija mea"',subtitle:'QR inteligent pentru sănătate și urgențe',tagline:'Elementele tale medicale esențiale—la o scanare distanță.',description:'Când secundele contează, MYQER arată instantaneu informațiile tale vitale echipelor de urgență.',login:'Conectare',signup:'Înregistrare',about:'Despre',contact:'Contact',privacy:'Confidențialitate',terms:'Termeni'},
      ar:{pronunciation:'يُنطق "رعايتي"',subtitle:'رمز QR ذكي للصحة والطوارئ',tagline:'أساسياتك الطبية—على بُعد مسح واحد.',description:'عندما تكون الثواني مهمة، يُظهر MYQER فوراً معلوماتك الحيوية لفرق الإسعاف الأولي.',login:'تسجيل الدخول',signup:'إنشاء حساب',about:'حول',contact:'اتصال',privacy:'الخصوصية',terms:'الشروط'},
      zh:{pronunciation:'发音为"我的关怀"',subtitle:'智能健康与急救二维码',tagline:'您的医疗必需品—一扫即得。',description:'当分秒必争时，MYQER立即向急救人员显示您的重要信息。',login:'登录',signup:'注册',about:'关于',contact:'联系',privacy:'隐私',terms:'条款'}
    };
    let currentLanguage='en';
    window.changeLanguage=(lang)=>{
      currentLanguage=lang;
      document.querySelectorAll('.language-item').forEach(i=>i.classList.remove('active'));
      if (window.event?.target) window.event.target.classList.add('active');
      document.querySelectorAll('[data-translate]').forEach(el=>{
        const key=el.getAttribute('data-translate');
        if(translations[lang]?.[key]) el.textContent = translations[lang][key];
      });
      toggleDropdown();
    };
    </script>

    <!-- (Kept) Cloudflare snippet -->
    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97e8850163acaf0c',t:'MTc1Nzc3NTY4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>
